package com.sweetsdelight_bk.Service;

import java.awt.print.Pageable;
import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageImpl;
import org.springframework.data.domain.PageRequest;

import com.sweetsdelight_bk.Exceptions.SweetDelightBkException;
import com.sweetsdelight_bk.Model.Cart;
import com.sweetsdelight_bk.Model.Category;
import com.sweetsdelight_bk.Model.Product;
import com.sweetsdelight_bk.Repository.CategoryRepository;

public class CategoryServiceImpl implements CategoryService {

	@Autowired
	CategoryRepository catrepo;
	
	@Override
	public Category addCategory(Category cat) {
		
		if(cat==null) throw new  SweetDelightBkException("Cart is null");
        return catrepo.save(cat);
	}

	@Override
	public Category updateCategory(int id,Category category) {
	     Optional< Category> cartt=catrepo.findById(id);
	     if(cartt.isEmpty()) 
		   throw new SweetDelightBkException("no category Availablable with this id");
	       return catrepo.save(category);
	    }

	@Override
	public Category deletecategory(int categoryid) {
		
		 Optional<Category> optionalCart = catrepo.findById(categoryid);
	        if(optionalCart.isEmpty()) throw new SweetDelightBkException("no cart availablable with this id");
	        	Category cart = optionalCart.get();
	            catrepo.deleteById(categoryid);
	            return cart;
	}

	@Override
	public List<Category> showAllcatageories() {
		
		return catrepo.findAll();
	}

	@Override
	public List<Product> showAllitemsincategory(int categoryid,int pageNumber,int pageSize) {
		
		 Optional<Category> optionalCart = catrepo.findById(categoryid);
	        if(optionalCart.isEmpty()) throw new SweetDelightBkException("no cart availablable with this id");
	        	Category category = optionalCart.get();
	        	 Pageable pageable = PageRequest.of(pageNumber, pageSize);
	        	    
	        	    // Get a paginated list of products
	        	    List<Product> products = category.getProducts();
	        	    Page<Product> paginatedProducts = new PageImpl<>(products, pageable, products.size());
	        	    
	        	    return paginatedProducts;
	        	
	       return 	category.getProducts();
	}



}
